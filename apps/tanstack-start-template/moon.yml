type: application
language: typescript
tags:
  - docker

dependsOn:
  - 'drizzle'

fileGroups:
  build:
    - '.output/**'

tasks:
  build:
    description: Build the app.
    command: pnpm build
    deps:
      - '~:install'
    inputs:
      - '@globs(sources)'
    outputs:
      - '@globs(build)'

  docker-build:
    deps:
      - '~:build'
    inputs:
      - '@globs(build)'
    env:
      DOCKER_NAME: tanstack-start-template/app

  docker-push:
    env:
      DOCKER_NAME: tanstack-start-template/app

  dev:
    options:
      envFile:
        - '.env.secrets'
